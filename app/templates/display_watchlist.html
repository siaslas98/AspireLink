{% extends "base.html" %} {% block form %}
<h2>Welcome, {{ user.username }}!</h2>

{% if msg %}
<div
  class="msg {% if 'removed' in msg.lower() or 'added' in msg.lower() %}success{% else %}error{% endif %}"
>
  {{ msg }}
</div>
{% endif %}

<form
  class="user-form"
  method="post"
  action="{{ request.url_for('add_to_watchlist') }}"
>
  <div class="form-group">
    <label for="company_name">Add Company:</label>
    <input
      id="company_name"
      name="company_name"
      type="text"
      placeholder="company name"
      required
    />
    <button type="submit">Add</button><br /><br />
  </div>
</form>

<h3>Your Watchlist</h3>
{% if watchlist_items %} {% for item in watchlist_items %}
<div class="watchlist-item">
  <span class="company-name">
    {{ item.company_name[:30] }}{% if item.company_name|length > 30 %}...{%
    endif %}
  </span>
  <small>Added: {{ item.added_at.strftime('%Y-%m-%d') }}</small>
  <form method="post" action="{{ request.url_for('remove_from_watchlist') }}">
    <input type="hidden" name="item_id" value="{{ item.id }}" />
    <button type="submit" class="remove-btn">Remove</button>
  </form>
</div>

{% endfor %} {% else %}
<p>No companies in your watchlist yet.</p>
{% endif %} {% endblock %}
